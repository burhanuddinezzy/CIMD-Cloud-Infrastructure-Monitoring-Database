<!--Just yesterday, I learnt that using a relational database managmeent system isnt the best choice for managing application logs and a time series databases exist for this reason. So, I will now create a separate database to collect application logs. I will be using elasticsearch server engine, and for data visualization, I will primairly use Grafana for system level metrics, and then use Tableau/PowerBI for business level metrics-->

# Elasticsearch 9.0.1 Installation & Setup Documentation

## Overview
This document describes the process of installing and configuring Elasticsearch 9.0.1 locally with security enabled by default. The setup is intended for use in a development environment for ingesting and analyzing infrastructure metrics.

---

## System Requirements

- Operating System: [Specify your OS, e.g., Windows 11, macOS Ventura, Ubuntu 22.04]
- Java: Bundled with Elasticsearch 9.0.1 (no separate Java installation required)
- Recommended RAM: Minimum 4GB

---

## Step 1: Download Elasticsearch 9.0.1

1. Navigate to the official Elasticsearch downloads page:  
   https://www.elastic.co/downloads/elasticsearch

2. Download the ZIP archive appropriate for your operating system, e.g.,  
   `elasticsearch-9.0.1-windows-x86_64.zip`

3. Extract the ZIP file to your preferred directory, for example:  
   `C:\Elastic\elasticsearch-9.0.1`

---

## Step 2: Start Elasticsearch

1. Open a terminal or PowerShell window.

2. Change directory to the `bin` folder inside the extracted Elasticsearch directory, e.g.:  
cd C:\Elastic\elasticsearch-9.0.1\bin

sql
Copy code

3. Start Elasticsearch by running:  
.\elasticsearch.bat

yaml
Copy code

Note: Elasticsearch 9.x and later versions start with security features enabled by default, including HTTPS and user authentication.

---

## Step 3: Access Elasticsearch

Elasticsearch will listen on the following secure URL:  
https://localhost:9200

pgsql
Copy code

When accessing this URL through a browser or an API client (e.g., Postman, curl), you will be prompted for authentication.

- Default username: `elastic`
- The password is automatically generated during the first startup and displayed in the terminal. Make sure to save it securely.

A successful response will look like the following JSON:

```json
{
  "name": "dfdfdfd",
  "cluster_name": "elasticsearch",
  "cluster_uuid": "Gwwewdfdfjvdfdfddfdfw",
  "version": {
    "number": "9.0.1",
    "build_flavor": "default",
    "build_type": "zip",
    "build_hash": "73f759erede941e151a5bbfbf01e364",
    "build_date": "2025-04-30T10:07:41.393025990Z",
    "build_snapshot": false,
    "lucene_version": "10.1.0",
    "minimum_wire_compatibility_version": "8.18.0",
    "minimum_index_compatibility_version": "8.0.0"
  },
  "tagline": "You Know, for Search"
}
Troubleshooting
Warning: Received plaintext HTTP traffic on an HTTPS channel
csharp
Copy code
[WARN ][o.e.h.n.Netty4HttpServerTransport] received plaintext http traffic on an https channel, closing connection
Cause: Attempting to connect using HTTP instead of HTTPS.

Solution: Always use HTTPS to access Elasticsearch, for example:

arduino
Copy code
https://localhost:9200
Verification
Test the Elasticsearch endpoint using curl:

bash
Copy code
curl -u elastic https://localhost:9200 --insecure
Or access it via a browser and provide the elastic username and password when prompted.

<!-- 
Need to start elasticsearch everytime you restart machine and run:
cd "C:\Users\replace_username\Downloads\elasticsearch-9.0.1-windows-x86_64\elasticsearch-9.0.1\bin"

.\elasticsearch.bat

Let that run. Now go to VM and tet connection from VM to elastic search through VM. Keep in mind, i've already set up a reverse SSH tunnel on port 9200 between localhost and VM 9200:localhost:9200 ant it's automatic (so restarts if it closes automatically).

If you havent SSH'd into the cloud VM, do that first so you can actually access the VM

Then on VM, run    curl -u elastic:<your-password> https://localhost:9200

For double checking elastic search is actually working, run this locally on terminal: curl -k -u elastic:<your-password> https://localhost:9200



-->

------------------ Docuemntation for running elastic search (with troubleshooting)---------------------------

Absolutely ‚Äî here is the **complete, merged documentation** including:

* ‚úÖ Goal
* üîß Setup Summary
* üñ•Ô∏è Commands to run on Windows & Ubuntu VM
* ‚úÖ Success condition
* üîÅ Daily restart checklist
* üîé Troubleshooting flow
* üìå Helpful notes

You can save or commit this as a `elasticsearch_reverse_tunnel_setup.md` file in your project or GitHub docs.

---

# ‚úÖ Access Local Elasticsearch from Remote VM Using Reverse SSH

This guide walks you through setting up and verifying a **reverse SSH tunnel** from your **local Windows machine** to your **Ubuntu VM**, allowing access to your locally running **Elasticsearch (port 9200)** from the VM.

---

## ‚úÖ Goal

Access **Elasticsearch** running on your **local Windows machine (`localhost:9200`)** from your **remote Ubuntu VM**, using a **reverse SSH tunnel**.

---

## üîß Setup Summary

### üîÅ Reverse SSH Tunnel (.bat file on Windows)

This `.bat` script sets up the tunnel:

```bat
@echo off
start "" ssh -i "C:\Users\burha\.ssh\cimd_postgresql_key" -N -R 9200:localhost:9200 ubuntu@<VM_PUBLIC_IP>
```

* `-R 9200:localhost:9200`: Forwards **VM‚Äôs port 9200** to your **local machine‚Äôs port 9200**
* `-i`: Your SSH private key path
* `ubuntu@<VM_PUBLIC_IP>`: Your VM's SSH login

üìÅ Save as:
`C:\Users\burha\Documents\reverse_tunnel.bat`

üéØ Use **Task Scheduler** to auto-run this `.bat` **on login** or **at system startup**.

---

## üñ•Ô∏è Commands to Run on Each Side

### ‚úÖ On Local Windows

#### 1. Start Elasticsearch

```cmd
cd C:\Users\burha\Downloads\elasticsearch-9.0.1-windows-x86_64\elasticsearch-9.0.1\bin
.\elasticsearch.bat
```

> ‚ö†Ô∏è Keep this window open ‚Äî it's your Elasticsearch server.

---

#### 2. Verify it's running locally

```cmd
curl -k -u elastic:<your-password> https://localhost:9200
```

‚úÖ Expected: JSON response from Elasticsearch.

---

#### 3. Check Elasticsearch is listening

```cmd
netstat -an | findstr 9200
```

‚úÖ Expected:

```
TCP    0.0.0.0:9200           0.0.0.0:0              LISTENING
```

---

#### 4. Check reverse SSH tunnel is running (optional)

```bash
ps aux | grep ssh
```

‚úÖ Should show something like:

```
ssh -i ... -N -R 9200:localhost:9200 ubuntu@<VM_PUBLIC_IP>
```

To kill all tunnels if needed:

```cmd
taskkill /F /IM ssh.exe
```

---

### ‚úÖ On Ubuntu VM

#### 1. Test tunnel connectivity

```bash
curl -k -u elastic:<your-password> https://localhost:9200
```

‚úÖ You should get:

```json
{
  "name" : "BEZZY",
  "cluster_name" : "elasticsearch",
  ...
  "tagline" : "You Know, for Search"
}
```

---

#### 2. Check if port 9200 is bound (via reverse tunnel)

```bash
sudo ss -tulnp | grep 9200
```

‚úÖ Expected:

```
tcp   LISTEN 0      128     127.0.0.1:9200     0.0.0.0:*   users:(("sshd",pid=...,fd=...))
```

---

## ‚úÖ SUCCESS CONDITION

On your **Ubuntu VM**, run:

```bash
curl -k -u elastic:<your-password> https://localhost:9200
```

‚úÖ Expected response (truncated):

```json
{
  "name" : "BEZZY",
  "cluster_name" : "elasticsearch",
  "version" : {
    "number" : "9.0.1",
    ...
  },
  "tagline" : "You Know, for Search"
}
```

> This confirms:
>
> * Reverse SSH tunnel is active
> * Elasticsearch is reachable from VM
> * Auth works (username/password correct)
> * Elasticsearch is up and running

---

## üîÅ DAILY RESTART CHECKLIST

Assuming Task Scheduler is already auto-running the tunnel, here's what you do after restarting your laptop:

### ‚úÖ Step 1: Start Elasticsearch on Windows

```cmd
cd C:\Users\burha\Downloads\elasticsearch-9.0.1-windows-x86_64\elasticsearch-9.0.1\bin
.\elasticsearch.bat
```

‚ö†Ô∏è Don't close this window ‚Äî it's your live server.

---

### ‚úÖ Step 2: Test from VM (after 5‚Äì10 seconds)

SSH into your VM and run:

```bash
curl -k -u elastic:<your-password> https://localhost:9200
```

‚úÖ If JSON is returned ‚Äî everything is working.

---

## üîé TROUBLESHOOTING FLOW

| Symptom                         | Command                                         | What to Expect           | Fix                                        |                                                  |
| ------------------------------- | ----------------------------------------------- | ------------------------ | ------------------------------------------ | ------------------------------------------------ |
| `curl` fails/hangs on VM        | `curl -k -u elastic:... https://localhost:9200` | JSON response            | Ensure Elasticsearch is running on Windows |                                                  |
| Tunnel not active               | \`ps aux                                        | grep ssh\`               | See `-R 9200:localhost:9200` line          | Manually re-run tunnel or restart Task Scheduler |
| Port not listening on VM        | \`sudo ss -tulnp                                | grep 9200\`              | See 127.0.0.1:9200 bound by sshd           | Re-check SSH tunnel or firewall                  |
| "Empty reply from server"       | `curl ...`                                      | JSON expected, got blank | Might be HTTPS/SSL issue; use `-k` switch  |                                                  |
| Nothing on port 9200 on Windows | \`netstat -an                                   | findstr 9200\`           | LISTENING on 0.0.0.0:9200                  | Restart Elasticsearch or re-check .bat           |

---

## üìå NOTES

* Always start **Elasticsearch before** the reverse SSH tunnel (or at the same time).
* If using **Task Scheduler**:

  * ‚úÖ Set to run at logon or startup
  * ‚úÖ Make sure `ssh.exe` is in PATH (or give full path in .bat)
  * ‚úÖ Enable "Run whether user is logged in or not"
* You can log SSH tunnel output to a file (optional):

```bat
start "" ssh -i "..." -N -R 9200:localhost:9200 ubuntu@<VM_IP> >> C:\path\to\log.txt 2>&1
```

---
